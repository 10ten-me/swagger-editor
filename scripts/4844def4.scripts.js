"use strict";function annotateYAMLErrors(a){var b=null,c=a.getSession().getValue();try{jsyaml.load(c)}catch(d){return b=d.message.replace("JS-YAML: ",""),a.getSession().setAnnotations([{row:d.mark.line,column:d.mark.column,text:b,type:"error"}]),b}return a.getSession().clearAnnotations(),b}function getJsonString(a){var b=jsyaml.load(a.getSession().getValue());return JSON.stringify(b,null,4)}function buildDocs(a){if(swaggerUi){var b=getJsonString(a.editor);swaggerUi.load(b),swaggerUi.render()}}function getDefaultSpecs(){return $.get("spec-files/default.yaml")}window.PhonicsApp=angular.module("PhonicsApp",["ngCookies","ngResource","ngSanitize","ngRoute","ui.ace","ngStorage"]),PhonicsApp.config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/:resource/:id",{templateUrl:"views/main.html",controller:"MainCtrl"}).otherwise({redirectTo:"/"})}]),PhonicsApp.controller("MainCtrl",["$scope","$localStorage",function(a,b){a.editor=null,a.jsonPreview=null,a.previewMode="html",a.editorErrorMessage="",a.autogenDocs=!0,window.swaggerUi=new SwaggerUi({dom_id:"swagger-ui-container",supportedSubmitMethods:["get","post","put","delete"]}),a.aceLoaded=function(c){return a.editor=c,b.cache?(c.getSession().setValue(b.cache),void buildDocs(a)):getDefaultSpecs().then(function(d){b.cache=d,c.getSession().setValue(d),buildDocs(a)})},a.jsonPreviewLoaded=function(b){a.jsonPreview=b},a.aceChanged=_.debounce(function(){var c=null;b.cache=a.editor.getSession().getValue(),c=annotateYAMLErrors(a.editor),c||(a.editorErrorMessage=""),a.autogenDocs&&buildDocs(a)},500),a.generateDocs=function(){buildDocs(a)},a.switchPreviewMode=function(b){a.previewMode=b,"json"===b&&a.jsonPreview.getSession().setValue(getJsonString(a.editor))},a.jsonLoaded=function(){}}]),PhonicsApp.directive("splitterBar",function(){return{template:"",replace:!1,restrict:"E",link:function(a,b,c){function d(a){var d=a.pageX,e=100;e>d||d>window.innerWidth-e||(b.css("left",d),$("#"+c.leftPane).css("width",d),$("#"+c.rightPane).css("width",window.innerWidth-d-b.width()))}var e=$(document);b.on("mousedown",function(a){a.preventDefault(),e.on("mousemove",d),e.on("mouseup",function(){e.off("mousemove",d)})})}}});